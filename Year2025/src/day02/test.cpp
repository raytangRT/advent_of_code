#include "solution.hpp"
#include "gmock/gmock.h"
#include "gtest/gtest.h"
#include <aoc/gtestHelpers.hpp>
#include <cstdlib>
#include <gtest/gtest.h>
#include <initializer_list>
#include <tuple>

using namespace Day02;

struct Day02Part1TestParam {
  long lower;
  long upper;

  std::vector<long> expectedValues;
};

class Day02TestSolvePart1 : public testing::TestWithParam<Day02Part1TestParam> {
};

TEST_P(Day02TestSolvePart1, TestDay02Part1) {
  const auto [lower, upper, expectedOutput] = GetParam();

  const auto output = find_dupes(lower, upper);

  EXPECT_EQ(output.size(), expectedOutput.size())
      << "lower = " << lower << " || upper = " << upper
      << ", outputLength = " << output.size()
      << ", expectedOutputLength = " << expectedOutput.size();
}
// clang-format off
// 3. Instantiate the Test Suite
INSTANTIATE_TEST_SUITE_P(Day02_Part1Solver, Day02TestSolvePart1, aoc::test_params<Day02Part1TestParam>({
  {11, 12, {11 }}
, {998, 1012, {1010}}
, {998, 1012, {1010}}
, {998, 1012, {1010}}
, {1188511880, 1188511890, {1188511885}}
, {222220, 222224, {222222}}
, {1698522, 1698528, {}}
, {446443, 446449, {446446}}
, {38593856, 38593862, {38593859}}
, {565653, 565659, {}}
, {824824821, 824824827, {}}
, {2121212118, 2121212124, {}}
, {25259, 67386, {}}
, {117, 403, {}}
, {32, 77, {33, 44, 55, 66, 77}}
, {1, 18, {11}}
, {642, 1335, {1010, 1111, 1212, 1313}}
, {1684, 2834, {1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828}}
, {3269, 7729, {3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959, 6060, 6161, 6262, 6363, 6464, 6565, 6666, 6767, 6868, 6969, 7070, 7171, 7272, 7373, 7474, 7575, 7676}}
, {25259, 67386, {}}
, {6534997, 6766843, {}}
, {4659420, 4693423, {}}
, {7778, 14058, {7878, 7979, 8080, 8181, 8282, 8383, 8484, 8585, 8686, 8787, 8888, 8989, 9090, 9191, 9292, 9393, 9494, 9595, 9696, 9797, 9898, 9999}}
, {655569300, 655755402, {}}
, {69689, 125217, {100100, 101101, 102102, 103103, 104104, 105105, 106106, 107107, 108108, 109109, 110110, 111111, 112112, 113113, 114114, 115115, 116116, 117117, 118118, 119119, 120120, 121121, 122122, 123123, 124124, 125125 }}
, {3939364590, 3939433455, {} }
, {83706740, 83939522, {8370, 8371, 8372, 8373, 8374, 8375, 8376, 8377, 8378, 8379, 8380, 8381, 8382, 8383, 8384, 8385, 8386, 8387, 8388, 8389, 8390, 8391, 8392, 8393}}
, {288352, 412983, {289289, 290290, 291291, 292292, 293293, 294294, 295295, 296296, 297297, 298298, 299299, 300300, 301301, 302302, 303303, 304304, 305305, 306306, 307307, 308308, 309309, 310310, 311311, 312312, 313313, 314314, 315315, 316316, 317317, 318318, 319319, 320320, 321321, 322322, 323323, 324324, 325325, 326326, 327327, 328328, 329329, 330330, 331331, 332332, 333333, 334334, 335335, 336336, 337337, 338338, 339339, 340340, 341341, 342342, 343343, 344344, 345345, 346346, 347347, 348348, 349349, 350350, 351351, 352352, 353353, 354354, 355355, 356356, 357357, 358358, 359359, 360360, 361361, 362362, 363363, 364364, 365365, 366366, 367367, 368368, 369369, 370370, 371371, 372372, 373373, 374374, 375375, 376376, 377377, 378378, 379379, 380380, 381381, 382382, 383383, 384384, 385385, 386386, 387387, 388388, 389389, 390390, 391391, 392392, 393393, 394394, 395395, 396396, 397397, 398398, 399399, 400400, 401401, 402402, 403403, 404404, 405405, 406406, 407407, 408408, 409409, 410410, 411411, 412412}}
, {743179, 799185, {743743, 744744, 745745, 746746, 747747, 748748, 749749, 750750, 751751, 752752, 753753, 754754, 755755, 756756, 757757, 758758, 759759, 760760, 761761, 762762, 763763, 764764, 765765, 766766, 767767, 768768, 769769, 770770, 771771, 772772, 773773, 774774, 775775, 776776, 777777, 778778, 779779, 780780, 781781, 782782, 783783, 784784, 785785, 786786, 787787, 788788, 789789, 790790, 791791, 792792, 793793, 794794, 795795, 796796, 797797, 798798}}
, {7298346751, 7298403555, {7298372983}}
, {3269, 7729, {3333, 3434, 3535, 3636, 3737, 3838, 3939, 4040, 4141, 4242, 4343, 4444, 4545, 4646, 4747, 4848, 4949, 5050, 5151, 5252, 5353, 5454, 5555, 5656, 5757, 5858, 5959, 6060, 6161, 6262, 6363, 6464, 6565, 6666, 6767, 6868, 6969, 7070, 7171, 7272, 7373, 7474, 7575, 7676}}
, {3939364590, 3939433455, {}}
, {867092, 900135, {867867, 868868, 869869, 870870, 871871, 872872, 873873, 874874, 875875, 876876, 877877, 878878, 879879, 880880, 881881, 882882, 883883, 884884, 885885, 886886, 887887, 888888, 889889, 890890, 891891, 892892, 893893, 894894, 895895, 896896, 897897, 898898, 899899}}
, {25259, 67386, {}}
, {95107011, 95138585, {95109510, 95119511, 95129512}}
, {655569300, 655755402, {}}
, {9372727140, 9372846709, {9372793727}}
, {986003, 1032361, {986986, 987987, 988988, 989989, 990990, 991991, 992992, 993993, 994994, 995995, 996996, 997997, 998998, 999999}}
, {69689, 125217, {100100, 101101, 102102, 103103, 104104, 105105, 106106, 107107, 108108, 109109, 110110, 111111, 112112, 113113, 114114, 115115, 116116, 117117, 118118, 119119, 120120, 121121, 122122, 123123, 124124, 125125}}
, {417160, 479391, {417417, 418418, 419419, 420420, 421421, 422422, 423423, 424424, 425425, 426426, 427427, 428428, 429429, 430430, 431431, 432432, 433433, 434434, 435435, 436436, 437437, 438438, 439439, 440440, 441441, 442442, 443443, 444444, 445445, 446446, 447447, 448448, 449449, 450450, 451451, 452452, 453453, 454454, 455455, 456456, 457457, 458458, 459459, 460460, 461461, 462462, 463463, 464464, 465465, 466466, 467467, 468468, 469469, 470470, 471471, 472472, 473473, 474474, 475475, 476476, 477477, 478478}}
, {642, 1335, {1010, 1111, 1212, 1313}}
, {521359, 592037, {521521, 522522, 523523, 524524, 525525, 526526, 527527, 528528, 529529, 530530, 531531, 532532, 533533, 534534, 535535, 536536, 537537, 538538, 539539, 540540, 541541, 542542, 543543, 544544, 545545, 546546, 547547, 548548, 549549, 550550, 551551, 552552, 553553, 554554, 555555, 556556, 557557, 558558, 559559, 560560, 561561, 562562, 563563, 564564, 565565, 566566, 567567, 568568, 569569, 570570, 571571, 572572, 573573, 574574, 575575, 576576, 577577, 578578, 579579, 580580, 581581, 582582, 583583, 584584, 585585, 586586, 587587, 588588, 589589, 590590, 591591}}
, {7456656494, 7456690478, {7456674566}}
, {38956690, 39035309, {38963896, 38973897, 38983898, 38993899, 39003900, 39013901, 39023902, 39033903}}
, {1, 18, {11}}
, {799312, 861633, {799799, 800800, 801801, 802802, 803803, 804804, 805805, 806806, 807807, 808808, 809809, 810810, 811811, 812812, 813813, 814814, 815815, 816816, 817817, 818818, 819819, 820820, 821821, 822822, 823823, 824824, 825825, 826826, 827827, 828828, 829829, 830830, 831831, 832832, 833833, 834834, 835835, 836836, 837837, 838838, 839839, 840840, 841841, 842842, 843843, 844844, 845845, 846846, 847847, 848848, 849849, 850850, 851851, 852852, 853853, 854854, 855855, 856856, 857857, 858858, 859859, 860860}}
, {674384, 733730, {674674, 675675, 676676, 677677, 678678, 679679, 680680, 681681, 682682, 683683, 684684, 685685, 686686, 687687, 688688, 689689, 690690, 691691, 692692, 693693, 694694, 695695, 696696, 697697, 698698, 699699, 700700, 701701, 702702, 703703, 704704, 705705, 706706, 707707, 708708, 709709, 710710, 711711, 712712, 713713, 714714, 715715, 716716, 717717, 718718, 719719, 720720, 721721, 722722, 723723, 724724, 725725, 726726, 727727, 728728, 729729, 730730, 731731, 732732}}
, {1684, 2834, {1717, 1818, 1919, 2020, 2121, 2222, 2323, 2424, 2525, 2626, 2727, 2828}}
, {605744, 666915, {606606, 607607, 608608, 609609, 610610, 611611, 612612, 613613, 614614, 615615, 616616, 617617, 618618, 619619, 620620, 621621, 622622, 623623, 624624, 625625, 626626, 627627, 628628, 629629, 630630, 631631, 632632, 633633, 634634, 635635, 636636, 637637, 638638, 639639, 640640, 641641, 642642, 643643, 644644, 645645, 646646, 647647, 648648, 649649, 650650, 651651, 652652, 653653, 654654, 655655, 656656, 657657, 658658, 659659, 660660, 661661, 662662, 663663, 664664, 665665, 666666}}
, {6534997, 6766843, {}}
, {4659420, 4693423, {}}
, {6161502941, 6161738969, {6161561615, 6161661616}}
, {932668, 985784, {932932, 933933, 934934, 935935, 936936, 937937, 938938, 939939, 940940, 941941, 942942, 943943, 944944, 945945, 946946, 947947, 948948, 949949, 950950, 951951, 952952, 953953, 954954, 955955, 956956, 957957, 958958, 959959, 960960, 961961, 962962, 963963, 964964, 965965, 966966, 967967, 968968, 969969, 970970, 971971, 972972, 973973, 974974, 975975, 976976, 977977, 978978, 979979, 980980, 981981, 982982, 983983, 984984}}
, {901838, 922814, {901901, 902902, 903903, 904904, 905905, 906906, 907907, 908908, 909909, 910910, 911911, 912912, 913913, 914914, 915915, 916916, 917917, 918918, 919919, 920920, 921921}}
, {137371, 216743, {138138, 139139, 140140, 141141, 142142, 143143, 144144, 145145, 146146, 147147, 148148, 149149, 150150, 151151, 152152, 153153, 154154, 155155, 156156, 157157, 158158, 159159, 160160, 161161, 162162, 163163, 164164, 165165, 166166, 167167, 168168, 169169, 170170, 171171, 172172, 173173, 174174, 175175, 176176, 177177, 178178, 179179, 180180, 181181, 182182, 183183, 184184, 185185, 186186, 187187, 188188, 189189, 190190, 191191, 192192, 193193, 194194, 195195, 196196, 197197, 198198, 199199, 200200, 201201, 202202, 203203, 204204, 205205, 206206, 207207, 208208, 209209, 210210, 211211, 212212, 213213, 214214, 215215, 216216}}
, {47446188, 47487754, {47454745, 47464746, 47474747, 47484748}}
, {117, 403, {}}
, {32, 77, {33, 44, 55, 66, 77}}
, {35299661, 35411975, {35303530, 35313531, 35323532, 35333533, 35343534, 35353535, 35363536, 35373537, 35383538, 35393539, 35403540}}
, {7778, 14058, {7878, 7979, 8080, 8181, 8282, 8383, 8484, 8585, 8686, 8787, 8888, 8989, 9090, 9191, 9292, 9393, 9494, 9595, 9696, 9797, 9898, 9999}}
, {83706740, 83939522, {83708370, 83718371, 83728372, 83738373, 83748374, 83758375, 83768376, 83778377, 83788378, 83798379, 83808380, 83818381, 83828382, 83838383, 83848384, 83858385, 83868386, 83878387, 83888388, 83898389, 83908390, 83918391, 83928392, 83938393}}
}));
// clang-format on

TEST(Day02, Part1Demo) {
  long result = solve("./input/Day02/input.test.txt");
  EXPECT_EQ(result, 1227775554);
}

TEST(Day02, Part1Actual) {
  long result = solve("./input/Day02/input.txt");
  EXPECT_GT(result, 1400504026);
  EXPECT_EQ(result, 40055209690);
}

TEST(Day02, Part2Demo) {
  long result = solve("./input/Day02/input.test.txt", true);
  EXPECT_EQ(result, 4174379265);
}

struct Day02Part2TestParam {
  long lower;
  long upper;

  std::vector<long> expectedValues;
};

class Day02TestSolvePart2 : public testing::TestWithParam<Day02Part2TestParam> {
};

TEST_P(Day02TestSolvePart2, TestDay02Part2) {
  const auto [lower, upper, expectedOutput] = GetParam();

  const auto output = find_dupes_part2(lower, upper);

  EXPECT_THAT(output, testing::UnorderedElementsAreArray(expectedOutput))
      << "lower = " << lower << " || upper = " << upper
      << ", outputLength = " << output.size()
      << ", expectedOutputLength = " << expectedOutput.size();
}

// clang-format off
// 3. Instantiate the Test Suite
INSTANTIATE_TEST_SUITE_P(Day02_Part2Solver, Day02TestSolvePart2, aoc::test_params<Day02Part2TestParam>({
  {1, 23, {11, 22}}
, {11, 22, {11, 22}}
, {95, 115, {99, 111}}
, {998, 1012, {999, 1010}}
, {1188511880, 1188511890, {1188511885}}
, {222220, 222224, {222222}}
, {1698522, 1698528, {}}
, {446443, 446449, {446446}}
, {38593856, 38593862, {38593859}}
, {565653, 565659, {565656}}
, {824824821, 824824827, {824824824}}
, {2121212118, 2121212124, {2121212121}}
}));
// clang-format on

TEST(Day02, Part2Actual) {
  long result = solve("./input/Day02/input.txt", true);
  EXPECT_EQ(result, 50857215650);
}

int main(int argc, char *argv[]) {
  return aoc::runUnitTests(argc, argv, "day02", true);
}
